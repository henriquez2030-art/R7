<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VerdeOfertas - Tu Tienda Online</title>
    
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Iconos de Lucide -->
    <script type="module" src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    <style>
        /* Estilo para la fuente Inter */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Transiciones suaves para los modales */
        .modal {
            transition: opacity 0.25s ease, visibility 0.25s ease;
        }
        .modal-content {
            transition: transform 0.25s ease;
        }
        /* Ocultar la barra de scroll en el carrusel de ofertas */
        #sale-product-grid::-webkit-scrollbar {
            display: none; /* Chrome, Safari y Opera */
        }
        #sale-product-grid {
            -ms-overflow-style: none;  /* IE y Edge */
            scrollbar-width: none;  /* Firefox */
            scroll-behavior: smooth; /* Desplazamiento suave */
        }
        /* Estilo para la imagen miniatura activa */
        .thumbnail-active {
            border-color: #16a34a; /* green-600 */
            box-shadow: 0 0 0 2px #dcfce7; /* green-100 */
        }
        /* Estilos para los botones del carrusel */
        .carousel-btn {
            @apply absolute top-1/2 -translate-y-1/2 bg-white bg-opacity-80 rounded-full p-2 text-gray-700 shadow-md transition-all duration-200 hover:bg-opacity-100 hover:scale-110 hidden md:flex;
        }
        .carousel-btn:disabled {
            @apply opacity-30 cursor-not-allowed;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- 
      *************************************************
      * ENCABEZADO Y NAVEGACIÓN (TEMA VERDE) *
      *************************************************
    -->
    <header class="bg-green-600 shadow-md sticky top-0 z-30 text-white">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center">
                    <span class="text-3xl font-bold">Verde</span>
                    <span class="text-3xl font-light">Ofertas</span>
                </div>

                <!-- Botón Carrito (Móvil) -->
                <div class="sm:hidden">
                    <button id="cart-button-mobile" class="relative p-2 rounded-full hover:bg-green-700 focus:outline-none">
                        <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                        <span id="cart-count-badge-mobile" class="hidden absolute -top-1 -right-1 w-5 h-5 bg-orange-500 text-white text-xs font-bold rounded-full flex items-center justify-center">0</span>
                    </button>
                </div>

                <!-- Botón Carrito (Escritorio) -->
                <div class="hidden sm:block">
                    <button id="cart-button-desktop" class="relative flex items-center gap-2 p-2 px-4 rounded-full hover:bg-green-700 focus:outline-none">
                        <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                        <span class="font-medium">Carrito</span>
                        <span id="cart-count-badge-desktop" class="hidden w-5 h-5 bg-orange-500 text-white text-xs font-bold rounded-full items-center justify-center">0</span>
                    </button>
                </div>
            </div>
            
            <!-- Barra de Búsqueda -->
            <div class="py-3">
                 <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                    </div>
                    <input
                        id="search-input"
                        type="search"
                        class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-full leading-5 bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"
                        placeholder="Buscar en VerdeOfertas..."
                    >
                </div>
            </div>
        </nav>
    </header>

    <!-- 
      *************************************************
      * SECCIÓN DE OFERTAS MEJORADA      *
      *************************************************
    -->
    <section class="container mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <div class="bg-white rounded-xl shadow-lg p-4 relative overflow-hidden">
            <h2 class="text-3xl font-bold mb-4 text-green-800 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-orange-500"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>
                Ofertas del Día
            </h2>
            
            <!-- Contenedor del Carrusel -->
            <div id="sale-product-grid" class="flex overflow-x-auto gap-4 pb-4">
                <!-- Los productos en oferta se insertarán aquí dinámicamente -->
            </div>
            
            <!-- Botones del Carrusel -->
            <button id="sale-scroll-left" class="carousel-btn left-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><polyline points="15 18 9 12 15 6"></polyline></svg>
            </button>
            <button id="sale-scroll-right" class="carousel-btn right-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><polyline points="9 18 15 12 9 6"></polyline></svg>
            </button>
        </div>
    </section>

    <!-- 
      *************************************************
      * LISTA DE "TODOS LOS PRODUCTOS"  *
      *************************************************
    -->
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <h2 class="text-2xl font-bold mb-4 text-gray-800">Todos los Productos</h2>
        <div id="product-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6">
            <!-- Los productos se insertarán aquí dinámicamente -->
        </div>
        <div id="no-results" class="hidden text-center text-gray-500 mt-10 text-xl">
            <p>No se encontraron productos que coincidan con tu búsqueda.</p>
        </div>
    </main>

    <!-- 
      *************************************************
      * MODAL: DETALLES DEL PRODUCTO      *
      *************************************************
    -->
    <div id="product-detail-modal" class="modal fixed inset-0 z-40 flex items-center justify-center bg-black bg-opacity-50 invisible opacity-0">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-11/12 md:w-3/4 lg:w-2/3 max-w-4xl p-6 transform -translate-y-10">
            <div class="flex justify-between items-center pb-3 border-b mb-4">
                <h2 id="detail-product-name" class="text-2xl font-bold text-gray-800"></h2>
                <button id="close-detail-btn" class="p-1 rounded-full text-gray-500 hover:bg-gray-200">
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
            
            <div class="flex flex-col md:flex-row gap-6">
                <!-- Galería de Imágenes -->
                <div class="md:w-1/2 flex flex-col items-center">
                    <img id="detail-main-image" src="https://placehold.co/600x600" alt="Producto principal" class="w-full h-80 object-contain rounded-lg border border-gray-200 mb-4">
                    <div id="detail-thumbnails" class="flex gap-2 overflow-x-auto w-full justify-center">
                        <!-- Miniaturas se insertan aquí -->
                    </div>
                </div>

                <!-- Detalles y Botón de Compra -->
                <div class="md:w-1/2 flex flex-col">
                    <p id="detail-product-description" class="text-gray-700 text-base mb-4"></p>
                    <div id="detail-product-price-info" class="mb-6">
                        <!-- Precio se inserta aquí -->
                    </div>
                    <button 
                        id="detail-add-to-cart-btn"
                        class="w-full bg-green-600 text-white py-3 px-4 rounded-lg text-lg font-semibold hover:bg-green-700 transition-colors mt-auto"
                        data-id=""
                        data-name=""
                        data-price=""
                    >
                        Añadir al carrito
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- 
      *************************************************
      * MODAL: CARRITO DE COMPRAS      *
      *************************************************
    -->
    <div id="cart-modal" class="modal fixed inset-0 z-40 flex items-center justify-center bg-black bg-opacity-50 invisible opacity-0">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-11/12 md:w-1/2 lg:w-1/3 max-w-lg p-6 transform -translate-y-10">
            <!-- Encabezado del Modal -->
            <div class="flex justify-between items-center pb-3 border-b">
                <h2 class="text-2xl font-bold text-gray-800">Carrito de Compras</h2>
                <button id="close-cart-btn" class="p-1 rounded-full text-gray-500 hover:bg-gray-200">
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>

            <!-- Items del Carrito -->
            <div id="cart-items" class="my-4 max-h-64 overflow-y-auto divide-y divide-gray-200 pr-2">
                <p id="cart-empty-msg" class="text-gray-500 text-center py-4">Tu carrito está vacío.</p>
            </div>

            <!-- Pie del Modal (Total y Botón de Comprar) -->
            <div class="border-t pt-4">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-xl font-bold text-gray-800">Total:</span>
                    <span id="cart-total" class="text-xl font-bold text-gray-800">$0.00</span>
                </div>
                <button id="buy-button" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg text-lg font-semibold hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                    COMPRAR
                </button>
            </div>
        </div>
    </div>

    <!-- 
      *************************************************
      * MODAL: RESUMEN Y WHATSAPP           *
      *************************************************
    -->
    <div id="invoice-modal" class="modal fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 invisible opacity-0">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-11/12 md:w-1/2 lg:w-1/3 max-w-lg p-6 transform -translate-y-10">
            <!-- Encabezado del Modal -->
            <div class="flex justify-between items-center pb-3 border-b">
                <h2 class="text-2xl font-bold text-gray-800">Resumen del Pedido</h2>
                <button id="close-invoice-btn" class="p-1 rounded-full text-gray-500 hover:bg-gray-200">
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>

            <!-- Contenido del "Recibo" -->
            <div class="my-4">
                <p class="text-gray-700 mb-3">Este es el resumen de tu pedido. Haz clic en el botón para enviarlo por WhatsApp.</p>
                <textarea 
                    id="invoice-text" 
                    rows="10" 
                    class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50 text-sm text-gray-800 focus:outline-none focus:ring-2 focus:ring-green-500" 
                    readonly
                ></textarea>
            </div>

            <!-- Botón de WhatsApp -->
            <a 
                id="whatsapp-link"
                href="#"
                target="_blank"
                class="flex items-center justify-center gap-3 w-full bg-green-500 text-white py-3 px-4 rounded-lg text-lg font-semibold hover:bg-green-600 transition-colors"
            >
                <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.451-4.437-9.887-9.889-9.887-5.451 0-9.887 4.436-9.889 9.887.001 2.231.612 4.279 1.739 6.03l-.351 1.291z"/></svg>
                Enviar pedido por WhatsApp
            </a>
        </div>
    </div>

    <!-- 
      *************************************************
      * JAVASCRIPT (LA LÓGICA)         *
      *************************************************
    -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // =================================================================
            //           1. CONFIGURACIÓN INICIAL Y DATOS DE EJEMPLO
            // =================================================================

            // -----------------------------------------------------------------
            //  ¡¡¡ IMPORTANTE !!!
            //  Reemplaza este número con tu número de WhatsApp.
            // -----------------------------------------------------------------
            const WHATSAPP_NUMBER = '18091234567'; // <--- CAMBIA ESTE NÚMERO

            // Datos de ejemplo de los productos (con 'stock' para ofertas)
            const mockProducts = [
                // Productos en Oferta
                { 
                    id: 1, 
                    name: 'Camiseta Verde de Algodón (Oferta)', 
                    price: 9.99, 
                    oldPrice: 15.99, 
                    onSale: true, 
                    stock: 20,
                    description: 'Cómoda camiseta de algodón 100% orgánico...',
                    images: ['https://placehold.co/300x300/22c55e/f0fdf4?text=Camiseta_Frontal', 'https://placehold.co/300x300/22c55e/f0fdf4?text=Camiseta_Espalda', 'https://placehold.co/300x300/22c55e/f0fdf4?text=Camiseta_Detalle']
                },
                { 
                    id: 2, 
                    name: 'Decoración Colgante de Hojas Verdes', 
                    price: 7.50, 
                    oldPrice: 12.00, 
                    onSale: true, 
                    stock: 15,
                    description: 'Hermosa decoración artificial para el hogar...',
                    images: ['https://placehold.co/300x300/a3e635/f7fee7?text=Decoración_1', 'https://placehold.co/300x300/a3e635/f7fee7?text=Decoración_2', 'https://placehold.co/300x300/a3e635/f7fee7?text=Decoración_3']
                },
                { 
                    id: 3, 
                    name: 'Lámpara de Escritorio LED Recargable', 
                    price: 22.90, 
                    oldPrice: 35.00, 
                    onSale: true, 
                    stock: 10,
                    description: 'Lámpara LED con intensidad regulable...',
                    images: ['https://placehold.co/300x300/84cc16/ecfccb?text=Lámpara_Frontal', 'https://placehold.co/300x300/84cc16/ecfccb?text=Lámpara_Encendida', 'https://placehold.co/300x300/84cc16/ecfccb?text=Lámpara_Lateral']
                },
                { 
                    id: 4, 
                    name: 'Reloj de Pared Minimalista', 
                    price: 18.00, 
                    oldPrice: 25.00, 
                    onSale: true, 
                    stock: 30,
                    description: 'Reloj de pared con diseño minimalista...',
                    images: ['https://placehold.co/300x300/f97316/fff7ed?text=Reloj_Frente', 'https://placehold.co/300x300/f97316/fff7ed?text=Reloj_Angulo', 'https://placehold.co/300x300/f97316/fff7ed?text=Reloj_Detalle']
                },
                { 
                    id: 5, 
                    name: 'Set de Tazas de Café Verdes (x4)', 
                    price: 12.00, 
                    oldPrice: 20.00, 
                    onSale: true, 
                    stock: 25,
                    description: 'Set de 4 tazas de cerámica de alta calidad...',
                    images: ['https://placehold.co/300x300/fb923c/fff7ed?text=Tazas_Juego', 'https://placehold.co/300x300/fb923c/fff7ed?text=Tazas_Individual', 'https://placehold.co/300x300/fb923c/fff7ed?text=Tazas_Apiladas']
                },
                { 
                    id: 17, 
                    name: 'Audífonos Inalámbricos Verdes', 
                    price: 49.99,
                    oldPrice: 79.99,
                    onSale: true,
                    stock: 18,
                    description: 'Audífonos Bluetooth con excelente calidad de sonido...',
                    images: ['https://placehold.co/300x300/059669/d1fae5?text=Audifonos_Frente', 'https://placehold.co/300x300/059669/d1fae5?text=Audifonos_Lateral', 'https://placehold.co/300x300/059669/d1fae5?text=Audifonos_Estuche']
                },
                { 
                    id: 18, 
                    name: 'Libreta Ecológica Verde (Oferta)', 
                    price: 5.50,
                    oldPrice: 8.50,
                    onSale: true,
                    stock: 50,
                    description: 'Libreta de tapas duras hecha con materiales reciclados...',
                    images: ['https://placehold.co/300x300/65a30d/f0fdf4?text=Libreta_Cerrada', 'https://placehold.co/300x300/65a30d/f0fdf4?text=Libreta_Abierta', 'https://placehold.co/300x300/65a30d/f0fdf4?text=Libreta_Detalle']
                },

                // Productos Regulares
                { 
                    id: 6, 
                    name: 'Jean Azul Clásico para Hombre', 
                    price: 45.50, 
                    description: 'Jean de corte recto, color azul oscuro...',
                    images: ['https://placehold.co/300x300/dbeafe/1e3a8a?text=Jean_Frontal', 'https://placehold.co/300x300/dbeafe/1e3a8a?text=Jean_Trasero', 'https://placehold.co/300x300/dbeafe/1e3a8a?text=Jean_Detalle']
                },
                { 
                    id: 7, 
                    name: 'Zapatillas Deportivas Ultra Ligeras', 
                    price: 79.90, 
                    description: 'Zapatillas ideales para correr...',
                    images: ['https://placehold.co/300x300/dcfce7/166534?text=Zapatillas_Lateral', 'https://placehold.co/300x300/dcfce7/166534?text=Zapatillas_Frente', 'https://placehold.co/300x300/dcfce7/166534?text=Zapatillas_Suela']
                },
                { 
                    id: 8, 
                    name: 'Gorra de Béisbol Negra Ajustable', 
                    price: 22.00, 
                    description: 'Gorra clásica de béisbol en color negro...',
                    images: ['https://placehold.co/300x300/fee2e2/991b1b?text=Gorra_Frente', 'https://placehold.co/300x300/fee2e2/991b1b?text=Gorra_Lateral', 'https://placehold.co/300x300/fee2e2/991b1b?text=Gorra_Ajuste']
                },
                { 
                    id: 9, 
                    name: 'Mochila Urbana Gris con USB', 
                    price: 55.25, 
                    description: 'Mochila moderna con compartimento para laptop...',
                    images: ['https://placehold.co/300x300/e5e7eb/1f2937?text=Mochila_Frente', 'https://placehold.co/300x300/e5e7eb/1f2937?text=Mochila_Abierta', 'https://placehold.co/300x300/e5e7eb/1f2937?text=Mochila_USB']
                },
                { 
                    id: 10, 
                    name: 'Lentes de Sol Estilo Aviador', 
                    price: 30.00, 
                    description: 'Lentes de sol con protección UV400...',
                    images: ['https://placehold.co/300x300/fef3c7/92400e?text=Lentes_Puestos', 'https://placehold.co/300x300/fef3c7/92400e?text=Lentes_Cerca', 'https://placehold.co/300x300/fef3c7/92400e?text=Lentes_Estuche']
                },
                { 
                    id: 11, 
                    name: 'Sudadera con Capucha Algodón', 
                    price: 42.00, 
                    description: 'Sudadera con capucha y bolsillo canguro...',
                    images: ['https://placehold.co/300x300/e2e8f0/475569?text=Sudadera_Frente', 'https://placehold.co/300x300/e2e8f0/475569?text=Sudadera_Espalda', 'https://placehold.co/300x300/e2e8f0/475569?text=Sudadera_Capucha']
                },
                { 
                    id: 12, 
                    name: 'Pantalón Cargo Verde Militar', 
                    price: 48.00, 
                    description: 'Pantalón cargo resistente con múltiples bolsillos...',
                    images: ['https://placehold.co/300x300/4d7c0f/d9f99d?text=Pantalón_Frente', 'https://placehold.co/300x300/4d7c0f/d9f99d?text=Pantalón_Lateral', 'https://placehold.co/300x300/4d7c0f/d9f99d?text=Pantalón_Bolsillo']
                },
                { 
                    id: 13, 
                    name: 'Cinturón de Cuero Genuino', 
                    price: 25.00, 
                    description: 'Cinturón de cuero de alta calidad...',
                    images: ['https://placehold.co/300x300/d4d4d4/404040?text=Cinturón_Frente', 'https://placehold.co/300x300/d4d4d4/404040?text=Cinturón_Detalle', 'https://placehold.co/300x300/d4d4d4/404040?text=Cinturón_Enrollado']
                },
                { 
                    id: 14, 
                    name: 'Bufanda de Lana Suave', 
                    price: 19.99, 
                    description: 'Bufanda cálida y suave, hecha de lana...',
                    images: ['https://placehold.co/300x300/e0e7ff/3730a3?text=Bufanda_Abierta', 'https://placehold.co/300x300/e0e7ff/3730a3?text=Bufanda_Doblada', 'https://placehold.co/300x300/e0e7ff/3730a3?text=Bufanda_Textura']
                },
                { 
                    id: 15, 
                    name: 'Set de Jardinería Básico Verde', 
                    price: 33.50, 
                    description: 'Kit esencial para jardinería...',
                    images: ['https://placehold.co/300x300/16a34a/dcfce7?text=Jardín_Herramientas', 'https://placehold.co/300x300/16a34a/dcfce7?text=Jardín_Empaque', 'https://placehold.co/300x300/16a34a/dcfce7?text=Jardín_Uso']
                },
                { 
                    id: 16, 
                    name: 'Maceta de Cerámica Verde', 
                    price: 14.00, 
                    description: 'Maceta de cerámica esmaltada...',
                    images: ['https://placehold.co/300x300/f1f5f9/334155?text=Maceta_Frente', 'https://placehold.co/300x300/f1f5f9/334155?text=Maceta_Planta', 'https://placehold.co/300x300/f1f5f9/334155?text=Maceta_Textura']
                },
            ];

            // Estado de la aplicación
            let cart = [];

            // Referencias a elementos del DOM
            const productGrid = document.getElementById('product-grid');
            const saleProductGrid = document.getElementById('sale-product-grid');
            const noResultsDiv = document.getElementById('no-results');
            const searchInput = document.getElementById('search-input');
            const cartButtons = [document.getElementById('cart-button-mobile'), document.getElementById('cart-button-desktop')];
            const cartCountBadges = [document.getElementById('cart-count-badge-mobile'), document.getElementById('cart-count-badge-desktop')];
            const cartModal = document.getElementById('cart-modal');
            const closeCartBtn = document.getElementById('close-cart-btn');
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            const buyButton = document.getElementById('buy-button');
            const invoiceModal = document.getElementById('invoice-modal');
            const closeInvoiceBtn = document.getElementById('close-invoice-btn');
            const invoiceText = document.getElementById('invoice-text');
            const whatsappLink = document.getElementById('whatsapp-link');
            const productDetailModal = document.getElementById('product-detail-modal');
            const closeDetailBtn = document.getElementById('close-detail-btn');
            const detailProductName = document.getElementById('detail-product-name');
            const detailProductDescription = document.getElementById('detail-product-description');
            const detailMainImage = document.getElementById('detail-main-image');
            const detailThumbnails = document.getElementById('detail-thumbnails');
            const detailProductPriceInfo = document.getElementById('detail-product-price-info');
            const detailAddToCartBtn = document.getElementById('detail-add-to-cart-btn');
            
            // Botones del carrusel de ofertas
            const saleScrollLeft = document.getElementById('sale-scroll-left');
            const saleScrollRight = document.getElementById('sale-scroll-right');


            // =================================================================
            //           2. FUNCIONES DE RENDERIZADO
            // =================================================================

            /**
             * Crea el HTML para una tarjeta de producto
             */
            function createProductCardHTML(product, type = 'grid') {
                const defaultImage = product.images && product.images.length > 0 ? product.images[0] : 'https://placehold.co/300x300/e0e0e0/333333?text=No+Image';
                let priceHTML, saleBadgeHTML, stockHTML = '';

                if (product.onSale && product.oldPrice) {
                    const discount = Math.round(((product.oldPrice - product.price) / product.oldPrice) * 100);
                    priceHTML = `
                        <div class="flex items-end gap-2 mt-1">
                            <p class="text-xl ${type === 'sale' ? '' : 'md:text-2xl'} font-bold text-orange-600">$${product.price.toFixed(2)}</p>
                            <p class="text-sm text-gray-500 line-through">$${product.oldPrice.toFixed(2)}</p>
                        </div>
                    `;
                    saleBadgeHTML = `
                        <div class="absolute top-2 ${type === 'grid' ? 'right-2' : 'left-2'} bg-orange-500 text-white text-xs font-bold px-3 py-1 rounded-full uppercase shadow-lg z-10">
                            -${discount}%
                        </div>
                    `;
                    if (type === 'sale' && product.stock) {
                        stockHTML = `
                            <div class="w-full bg-orange-100 rounded-full h-2.5 mt-2 overflow-hidden">
                                <div class="bg-orange-500 h-2.5 rounded-full" style="width: ${product.stock > 50 ? 25 : (product.stock * 2)}%"></div>
                            </div>
                            <p class="text-xs text-orange-600 font-semibold mt-1">¡Quedan ${product.stock}!</p>
                        `;
                    }

                } else {
                    priceHTML = `<p class="text-xl ${type === 'grid' ? 'md:text-2xl' : ''} font-bold text-gray-800 mt-1">$${product.price.toFixed(2)}</p>`;
                }
                
                const cardWidth = type === 'sale' ? 'min-w-[220px] w-[220px]' : '';
                const imageHeight = type === 'sale' ? 'h-36' : 'h-48';
                const padding = type === 'sale' ? 'p-3' : 'p-4';
                const titleSize = type === 'sale' ? 'text-sm' : 'text-base';


                return `
                    <div class="product-card bg-white rounded-lg shadow-lg overflow-hidden transition-transform duration-300 hover:scale-105 relative cursor-pointer flex flex-col" data-id="${product.id}">
                        ${saleBadgeHTML}
                        <img src="${defaultImage}" alt="${product.name}" class="w-full ${imageHeight} object-cover">
                        <div class="${padding} flex flex-col flex-grow">
                            <h3 class="${titleSize} font-semibold text-gray-800 truncate">${product.name}</h3>
                            ${priceHTML}
                            ${stockHTML}
                            <button 
                                class="add-to-cart-btn mt-4 w-full bg-green-600 text-white py-2 px-3 rounded-lg font-semibold hover:bg-green-700 transition-colors text-sm"
                                data-id="${product.id}"
                                data-name="${product.name}"
                                data-price="${product.price}"
                            >
                                Añadir al carrito
                            </button>
                        </div>
                    </div>
                `;
            }

            /**
             * Renderiza los productos en la cuadrícula principal
             */
            function renderProducts(products) {
                productGrid.innerHTML = '';
                
                if (products.length === 0) {
                    noResultsDiv.classList.remove('hidden');
                } else {
                    noResultsDiv.classList.add('hidden');
                }

                products.forEach(product => {
                    productGrid.innerHTML += createProductCardHTML(product, 'grid');
                });
            }
            
            /**
             * Renderiza los productos en el carrusel de ofertas
             */
            function renderSaleProducts(products) {
                saleProductGrid.innerHTML = '';
                products.forEach(product => {
                    saleProductGrid.innerHTML += createProductCardHTML(product, 'sale');
                });
            }

            /**
             * Muestra el modal de detalles de un producto específico
             */
            function showProductDetail(productId) {
                const product = mockProducts.find(p => p.id === productId);
                if (!product) return;

                detailProductName.textContent = product.name;
                detailProductDescription.textContent = product.description || 'Sin descripción disponible.';

                // Configurar el botón "Añadir al carrito"
                detailAddToCartBtn.dataset.id = product.id;
                detailAddToCartBtn.dataset.name = product.name;
                detailAddToCartBtn.dataset.price = product.price;

                // Información de precios
                let priceHtmlContent = '';
                if (product.oldPrice) {
                    const discount = Math.round(((product.oldPrice - product.price) / product.oldPrice) * 100);
                    priceHtmlContent = `
                        <div class="flex items-end gap-3">
                            <p class="text-3xl font-bold text-orange-600">$${product.price.toFixed(2)}</p>
                            <p class="text-lg text-gray-500 line-through">$${product.oldPrice.toFixed(2)}</p>
                            <span class="bg-orange-100 text-orange-800 text-xs font-medium px-2.5 py-0.5 rounded-full">
                                ¡${discount}% DCTO!
                            </span>
                        </div>
                    `;
                } else {
                    priceHtmlContent = `<p class="text-3xl font-bold text-gray-800">$${product.price.toFixed(2)}</p>`;
                }
                detailProductPriceInfo.innerHTML = priceHtmlContent;


                // Cargar imágenes
                detailThumbnails.innerHTML = '';
                product.images.forEach((imgSrc, index) => {
                    const thumbnail = document.createElement('img');
                    thumbnail.src = imgSrc;
                    thumbnail.alt = `${product.name} - Vista ${index + 1}`;
                    thumbnail.classList.add(
                        'w-16', 'h-16', 'object-cover', 'rounded-lg', 'border-2', 'border-gray-300', 'cursor-pointer',
                        'hover:border-green-500', 'transition-all', 'duration-200'
                    );
                    if (index === 0) {
                        thumbnail.classList.add('thumbnail-active');
                        detailMainImage.src = imgSrc;
                    }
                    thumbnail.addEventListener('click', () => {
                        detailMainImage.src = imgSrc;
                        document.querySelectorAll('#detail-thumbnails img').forEach(t => t.classList.remove('thumbnail-active'));
                        thumbnail.classList.add('thumbnail-active');
                    });
                    detailThumbnails.appendChild(thumbnail);
                });

                if (product.images.length === 0) {
                    detailMainImage.src = 'https://placehold.co/600x600/e0e0e0/333333?text=No+Image';
                }

                toggleModal(productDetailModal, true);
            }


            // =================================================================
            //           3. LÓGICA DEL CARRITO Y MODALES
            // =================================================================

            function toggleModal(modal, open) {
                if (open) {
                    modal.classList.remove('invisible', 'opacity-0');
                    modal.querySelector('.modal-content').classList.remove('-translatey-10');
                } else {
                    modal.classList.add('opacity-0');
                    modal.querySelector('.modal-content').classList.add('-translate-y-10');
                    setTimeout(() => modal.classList.add('invisible'), 250);
                }
            }

            function addToCart(id, name, price) {
                const existingItem = cart.find(item => item.id === id);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ id, name, price, quantity: 1 });
                }
                updateCartUI();
            }

            function removeFromCart(id) {
                cart = cart.filter(item => item.id !== id);
                updateCartUI();
            }

            function updateCartUI() {
                cartItems.innerHTML = '';
                let total = 0;
                let totalItems = 0;

                if (cart.length === 0) {
                    cartItems.innerHTML = '<p class="text-gray-500 text-center py-4">Tu carrito está vacío.</p>';
                    buyButton.disabled = true;
                } else {
                    buyButton.disabled = false;
                    cart.forEach(item => {
                        const itemTotal = item.price * item.quantity;
                        total += itemTotal;
                        totalItems += item.quantity;

                        const cartItemHTML = `
                            <div class="flex justify-between items-center py-3">
                                <div class="flex-1 pr-4">
                                    <h4 class="font-semibold text-gray-800">${item.name}</h4>
                                    <p class="text-sm text-gray-600">$${item.price.toFixed(2)} x ${item.quantity}</p>
                                </div>
                                <div class="text-gray-800 font-semibold w-20 text-right pr-4">
                                    $${itemTotal.toFixed(2)}
                                </div>
                                <button class="remove-from-cart-btn text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100" data-id="${item.id}">
                                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                                </button>
                            </div>
                        `;
                        cartItems.innerHTML += cartItemHTML;
                    });
                }

                cartTotal.textContent = `$${total.toFixed(2)}`;

                cartCountBadges.forEach(badge => {
                    if (totalItems > 0) {
                        badge.textContent = totalItems;
                        badge.classList.remove('hidden');
                        badge.classList.add('flex');
                    } else {
                        badge.classList.add('hidden');
                        badge.classList.remove('flex');
                    }
                });
            }
            
            function generateInvoice() {
                if (cart.length === 0) return;

                let invoiceString = "¡Hola VerdeOfertas! 👋 Me gustaría hacer el siguiente pedido:\n\n";
                invoiceString += "==== MI PEDIDO ====\n\n";
                
                let total = 0;

                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    invoiceString += `📦 ${item.name}\n`;
                    invoiceString += `   (Cantidad: ${item.quantity} x $${item.price.toFixed(2)}) = $${itemTotal.toFixed(2)}\n\n`;
                });

                invoiceString += "===================\n";
                invoiceString += `TOTAL DEL PEDIDO: $${total.toFixed(2)}\n\n`;
                invoiceString += "Espero confirmación. ¡Muchas gracias!";

                invoiceText.value = invoiceString;

                const encodedText = encodeURIComponent(invoiceString);
                whatsappLink.href = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodedText}`;

                toggleModal(cartModal, false);
                toggleModal(invoiceModal, true);
            }


            // =================================================================
            //           4. MANEJADORES DE EVENTOS (¡SECCIÓN CORREGIDA!)
            // =================================================================

            // Evento para el buscador
            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filteredProducts = mockProducts.filter(product => 
                    product.name.toLowerCase().includes(searchTerm) ||
                    (product.description && product.description.toLowerCase().includes(searchTerm))
                );
                renderProducts(filteredProducts);
            });

            // Evento para AÑADIR AL CARRITO (desde las tarjetas) y ABRIR DETALLES
            // Usamos delegación de eventos en las propias cuadrículas
            function handleGridClick(e) {
                const addToCartBtn = e.target.closest('.add-to-cart-btn');
                const productCard = e.target.closest('.product-card');

                if (addToCartBtn) {
                    // Detener la propagación para que no se abra el modal
                    e.stopPropagation(); 
                    
                    const id = parseInt(addToCartBtn.dataset.id);
                    const name = addToCartBtn.dataset.name;
                    const price = parseFloat(addToCartBtn.dataset.price);
                    addToCart(id, name, price);

                    // Feedback visual
                    const originalText = addToCartBtn.innerHTML;
                    addToCartBtn.innerHTML = '¡Añadido!';
                    addToCartBtn.disabled = true;
                    setTimeout(() => {
                        addToCartBtn.innerHTML = 'Añadir al carrito'; // Reset text
                        addToCartBtn.disabled = false;
                    }, 1000);
                    return;
                }

                if (productCard) {
                    // Si se hizo clic en la tarjeta (y no en el botón), abrir detalles
                    const productId = parseInt(productCard.dataset.id);
                    showProductDetail(productId);
                }
            }
            
            productGrid.addEventListener('click', handleGridClick);
            saleProductGrid.addEventListener('click', handleGridClick);

            // Evento para AÑADIR AL CARRITO (desde el modal de detalles)
            detailAddToCartBtn.addEventListener('click', () => {
                const id = parseInt(detailAddToCartBtn.dataset.id);
                const name = detailAddToCartBtn.dataset.name;
                const price = parseFloat(detailAddToCartBtn.dataset.price);
                
                addToCart(id, name, price);
                
                // Feedback visual y cierre del modal
                const originalText = detailAddToCartBtn.textContent;
                detailAddToCartBtn.textContent = '¡Añadido! ✅';
                detailAddToCartBtn.classList.add('bg-green-800'); // Un verde más oscuro
                
                setTimeout(() => {
                    detailAddToCartBtn.textContent = originalText;
                    detailAddToCartBtn.classList.remove('bg-green-800');
                    toggleModal(productDetailModal, false); 
                }, 1000);
            });
            
            // Evento para eliminar del carrito
            cartItems.addEventListener('click', (e) => {
                const button = e.target.closest('.remove-from-cart-btn');
                if (button) {
                    const id = parseInt(button.dataset.id);
                    removeFromCart(id);
                }
            });

            // Eventos para abrir el modal del carrito
            cartButtons.forEach(button => {
                button.addEventListener('click', () => toggleModal(cartModal, true));
            });
            
            // Eventos para cerrar el modal del carrito
            closeCartBtn.addEventListener('click', () => toggleModal(cartModal, false));
            cartModal.addEventListener('click', (e) => {
                if (e.target === cartModal) toggleModal(cartModal, false);
            });

            // Eventos para cerrar el modal de detalles
            closeDetailBtn.addEventListener('click', () => toggleModal(productDetailModal, false));
            productDetailModal.addEventListener('click', (e) => {
                if (e.target === productDetailModal) toggleModal(productDetailModal, false);
            });

            // Evento para el botón "COMPRAR"
            buyButton.addEventListener('click', generateInvoice);

            // Eventos para cerrar el modal de factura
            closeInvoiceBtn.addEventListener('click', () => {
                toggleModal(invoiceModal, false);
                cart = [];
                updateCartUI();
            });
            
            // Eventos para el carrusel de ofertas
            saleScrollLeft.addEventListener('click', () => {
                saleProductGrid.scrollLeft -= 300;
            });
            saleScrollRight.addEventListener('click', () => {
                saleProductGrid.scrollLeft += 300;
            });
            
            // Habilitar/deshabilitar botones del carrusel según el scroll
            saleProductGrid.addEventListener('scroll', () => {
                saleScrollLeft.disabled = saleProductGrid.scrollLeft === 0;
                saleScrollRight.disabled = saleProductGrid.scrollLeft + saleProductGrid.clientWidth >= saleProductGrid.scrollWidth - 10; // -10 para margen de error
            });


            // =================================================================
            //           5. INICIALIZACIÓN
            // =================================================================
            
            // --- CAMBIO AQUÍ: .slice(0, 3) ---
            // Filtra los productos en oferta Y TOMA SOLO LOS PRIMEROS 3
            const saleProducts = mockProducts.filter(p => p.onSale).slice(0, 3);
            
            renderSaleProducts(saleProducts);
            renderProducts(mockProducts);
            updateCartUI();
            
            // Estado inicial de los botones del carrusel
            saleScrollLeft.disabled = true;
            // Comprobar si el scroll es necesario
            setTimeout(() => {
                saleScrollRight.disabled = saleProductGrid.scrollWidth <= saleProductGrid.clientWidth;
            }, 100); 

        });
    </script>

</body>
</html>
